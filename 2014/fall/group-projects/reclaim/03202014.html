<html>
  <head>
    <link href="03202014.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
<body>
    <div class="zombie"></div>
    <div class="human"></div>
    <div class="bullet"></div>
<!--
<button onclick = "moveUp()">Up</button>
<button onclick = "moveDown()">Down</button>
<button onclick = "moveLeft()">Left</button>
<button onclick = "moveRight()">Right</button>
-->

<script> 
    var score=0;
    
    var playerSize = 30;
    document.write(score);
    var w = window,
      d = document,
      e = d.documentElement,
      g = d.getElementsByTagName('body')[0],
      max_x = w.innerWidth || e.clientWidth || g.clientWidth,
      max_y = w.innerHeight|| e.clientHeight|| g.clientHeight;
//prompt("Would you like to play Reclaim?");
    document.body.style.background = '#cccccc';
    zombie  = document.querySelector('.zombie');
    zombie.style.top = '15px';
    zombie.style.left = '15px';
    human = document.querySelector('.human');
    human.style.top = '300px';
    human.style.left = '300px';
    bullet = document.querySelector('.bullet');
    bullet.style.top = '-1px';
    bullet.style.left = '-1px';
    
    document.onkeydown = checkKey;
    document.addEventListener('mousemove',onmousemove,false);
    document.addEventListener('mousedown',onmousedown,false);
    document.addEventListener('mouseup',onmouseup,false);
    //first argument: that you look/listen for(event), 2nd one: (function) is called, 3rd one: binding it to the context 
    //object.onclick = function(){
//<<<<<<< HEAD
    
    //create zombie every 10 sec
    function createZombie(){
        var zombie = document.createElement('div');
        zombie.classList.add('zombie');
        document.body.appendChild(zombie);
        var xRandomplace = Math.random()*max_x;
        var yRandomplace = Math.random()*max_y;
        zombie.style.top = xRandomplace + 'px';
        zombie.style.left = yRandomplace + 'px';
//        var zombieInterval = setInterval(function(){
//            moveToHuman(zombie);
//            checkForCollisionsZombies(zombie);
//            if(!zombie.parentElement){
//                clearInterval(zombieInterval);
//            }
//        },1000/30);  //calculating every 30th of a second //1000 miliseconds = 1 second
    }
    
    setInterval(createZombie,1000);     //10,000 milisex = 10 sec
    
    
    
    
    function onmousemove(){
        console.log("moved");
    }
    function onmousedown(event){
        console.log(event);
        var HumanRect = human.getBoundingClientRect();
        bulletStartTop = HumanRect.top;//parseFloat(human.style.top);
        bulletStartLeft = HumanRect.left;//parseFloat(human.style.left);
        var bullet = document.createElement('div');     //creates a div on document, a place to put the bullet in/on
        bullet.classList.add('bullet');     //adds a bullet div
        document.body.appendChild(bullet);      //puts the bullet on the document otherwise leaves the bullet hanging around
//=======
    function onmousemove(){
        console.log("moved");
    }
    function onmousedown(){
        console.log("down");
        bulletStartTop = parseFloat(human.style.top) + playerSize/2;
        bulletStartLeft = parseFloat(human.style.left) + playerSize/2;
//>>>>>>> parent of a0b4219... ZOMBIESSSS, BULLETS, COLLISIONS
        bullet.style.top = bulletStartTop + 'px';
        bullet.style.left = bulletStartLeft + 'px';
        bullet.style.visibility = 'visible';
        
<<<<<<< HEAD
        //has bullet going in direction of mouseclick
        
        var speed = 1;
        var BulletRect = bullet.getBoundingClientRect();
        //var xBullet = parseFloat(bullet.style.left);
        var xMouse = event.clientX;
      //  var yBullet = parseFloat(bullet.style.top);
        var yMouse = event.clientY;
        var xDifference = xMouse - BulletRect.left;
        var yDifference = yMouse - BulletRect.top;
        var distance = Math.sqrt(Math.pow(xDifference, 2) + Math.pow(yDifference, 2));
        bullet.xTravel = xDifference/distance/speed;
        bullet.yTravel = yDifference/distance/speed;
        console.log("x " + bullet.xTravel);
        console.log("y " + bullet.yTravel);
//        var bulletInterval = setInterval(function(){
//            var xBullet = parseFloat(bullet.style.left);
//            var yBullet = parseFloat(bullet.style.top);
//            var yAddOn = yBullet + yTravel;
//            bullet.style.top = yAddOn + 'px';
//            var xAddOn = xBullet + xTravel;
//            bullet.style.left = xAddOn + 'px';
//                if(!bullet.parentElement){
//                    clearInterval(bulletInterval);
//                }
//        },1000/300);
=======
        bulletInterval = setInterval(bulletMove,1000/300);
        
        
        //pool
        //array of bullets, have index keep track of bullet 
        //BUGS : 
        //       - bullet speed increases as you keep clicking
        //       - after restarting zombie stops where bullet last hit it
        //       - can only create one bullet at a time
        //       - zombie dying alert pops up even without the zombie on screen

>>>>>>> parent of a0b4219... ZOMBIESSSS, BULLETS, COLLISIONS
        
    }
    function onmouseup(){
        console.log("up");  
    }
    
    
    function moveUp(person){
      goUp = parseInt(person.style.top) - 5;
      if (!(goUp < 0)) {
        person.style.top = goUp + 'px';
      }
    }
    function moveDown(person){
      goDown = parseInt(person.style.top) + 5;
      if(!(goDown > max_y - playerSize)){
      person.style.top = goDown + 'px';
      }
    }
    function moveLeft(person){
      goLeft = parseInt(person.style.left) - 5;
      if(!(goLeft < 0)){
      person.style.left = goLeft + 'px';
      }
    }
    function moveRight(person){
      goRight = parseInt(person.style.left) + 5;
      if(!(goRight > max_x - playerSize)){
      person.style.left = goRight + 'px';
      }
    }
    //user function
    function checkKey(e){
        console.log("hi");
        e = e || window.event;
        console.log(e);
        if(e.keyCode === 87 || e.keyCode === 38){ //87 w //38 up arrow
            moveUp(human);
        }
        if(e.keyCode === 83 || e.keyCode === 40){ //83 s //40 down arrow
            moveDown(human);
        }
        if(e.keyCode === 65 || e.keyCode === 37){ //65 a //37 left arrow
           moveLeft(human);
        }
        if(e.keyCode === 68 || e.keyCode === 39){ //68 d //39 right arrow
           moveRight(human);
        }
        if(e.keyCode === 27){ //esc
            zombie.style.top = '15px';
            zombie.style.left = '15px';
            human.style.top = '300px';
            human.style.left = '300px';  
            clearInterval(interval);
            
            //interval = setInterval(everyFrame, 1000/30);
            zombie.style.visibility = 'visible';
        }
    };
    
<<<<<<< HEAD
    //having the zombie move towards human
    moveToHuman = function(zombie){
        var speed = 1;
        var HumanRect = human.getBoundingClientRect();
        var ZombieRect = zombie.getBoundingClientRect();
        //var xHuman = parseFloat(human.style.left);
        //var xZombie = parseFloat(zombie.style.left);
        //var yHuman = parseFloat(human.style.top);
        //var yZombie = parseFloat(zombie.style.top);
        var xDifference = HumanRect.left - ZombieRect.left; //xHuman - xZombie;
        var yDifference = HumanRect.top - ZombieRect.top; //yHuman - yZombie;
        var distance = Math.sqrt(Math.pow(xDifference, 2) + Math.pow(yDifference, 2));
        var xTravel = xDifference/distance/speed;
        var yTravel = yDifference/distance/speed;
        var yAddOn = ZombieRect.top + yTravel; //yZombie + yTravel;
        zombie.style.top = yAddOn + 'px';
        var xAddOn = ZombieRect.left + xTravel; // xZombie + xTravel; 
=======
    everyFrame = function(){
        speed = 1;
        xHuman = parseFloat(human.style.left);
        xZombie = parseFloat(zombie.style.left);
        yHuman = parseFloat(human.style.top);
        yZombie = parseFloat(zombie.style.top);
        xDifference = xHuman - xZombie;
        yDifference = yHuman - yZombie;
        distance = Math.sqrt(Math.pow(xDifference, 2) + Math.pow(yDifference, 2));
        xTravel = xDifference/distance/speed;
        yTravel = yDifference/distance/speed;
        yAddOn = yZombie + yTravel;
        zombie.style.top = yAddOn + 'px';
        xAddOn = xZombie + xTravel; 
>>>>>>> parent of a0b4219... ZOMBIESSSS, BULLETS, COLLISIONS
        zombie.style.left = xAddOn + 'px';  
        if (distance < playerSize){
            alert('You died');
            clearInterval(interval);
        }
    };
<<<<<<< HEAD
    //if bullet hits zombie, zombie and bullet is removed
    
    checkForCollisionsZombies = function(zombie){
        var allBullets = document.querySelectorAll(".bullet");
        for(var i = 0; i < allBullets.length - 1;i++){
            var bullet = allBullets[i];     //lets all the code below work, check through ALL bullets
            
            var BulletRect = bullet.getBoundingClientRect(); //takes care of rounding errors
            var ZombieRect = zombie.getBoundingClientRect();
            //var xBullet = parseFloat(bullet.style.left);
            //var xZombie = parseFloat(zombie.style.left);
            //var yBullet = parseFloat(bullet.style.top);
            //var yZombie = parseFloat(zombie.style.top);
            
            var xDifference = ZombieRect.left - BulletRect.left;
            var yDifference = ZombieRect.top - BulletRect.top;
            var distance = Math.sqrt(Math.pow(xDifference, 2) + Math.pow(yDifference, 2));
            if(distance < playerSize){   
                console.log("gone");
                bullet.parentElement.removeChild(bullet);
                zombie.parentElement.removeChild(zombie);
                score=score+10;
                return;
            }
        }
    }
    
    //one interval to run everything at once
    gameLoop = function(){
        var allZombies = document.querySelectorAll(".zombie");
        var allBullets = document.querySelectorAll(".bullet");
        for(var i = 0; i < allZombies.length -1; i++){
            var zombie = allZombies[i];
            moveToHuman(zombie);
            checkForCollisionsZombies(zombie);
            
        }
        for(var i = 0; i <allBullets.length - 1; i++){
            var bullet = allBullets[i];
            var BulletRect = bullet.getBoundingClientRect();
            var ZombieRect = zombie.getBoundingClientRect();
           // var xBullet = parseFloat(bullet.style.left);
            //var yBullet = parseFloat(bullet.style.top);
            var yAddOn = BulletRect.top + bullet.yTravel;
            bullet.style.top = yAddOn + 'px';
            var xAddOn = BulletRect.left + bullet.xTravel;
            bullet.style.left = xAddOn + 'px';
        }
        requestAnimationFrame(gameLoop);
    }
    
    gameLoop();
    //setInterval(gameLoop,1000/30);
=======
    
    bulletMove = function(){
        speed = 1
        xBullet = parseFloat(bullet.style.left);
        xZombie = parseFloat(zombie.style.left);
        yBullet = parseFloat(bullet.style.top);
        yZombie = parseFloat(zombie.style.top);
        xDifference = xZombie - xBullet;
        yDifference = yZombie - yBullet;
        distance = Math.sqrt(Math.pow(xDifference, 2) + Math.pow(yDifference, 2));
        xTravel = xDifference/distance/speed;
        yTravel = yDifference/distance/speed;
        yAddOn = yBullet + yTravel;
        bullet.style.top = yAddOn + 'px';
        xAddOn = xBullet + xTravel;
        bullet.style.left = xAddOn + 'px';
        if (distance < playerSize){
            alert('Zombie died');
            clearInterval(bulletInterval);
            clearInterval(interval);
            bullet.style.top = human.style.top;
            bullet.style.left = human.style.left;
            bullet.style.visibility = 'hidden';
            zombie.style.visibility = 'hidden';
            clearInterval(bulletInterval);
        }
    };
    interval = setInterval(everyFrame, 1000/30);
>>>>>>> parent of a0b4219... ZOMBIESSSS, BULLETS, COLLISIONS
    
</script>
    
</body>
</html>